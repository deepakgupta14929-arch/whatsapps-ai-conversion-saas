<h1 class="text-2xl font-bold mb-2 text-white">Inbox</h1>
<p class="text-slate-400 text-sm mb-4">
  All leads for your account.
</p>

<div class="flex h-[calc(100vh-120px)] text-sm bg-slate-950/80 rounded-2xl overflow-hidden border border-slate-800">
  <!-- Left: lead list -->
  <aside class="w-72 border-r border-slate-800 bg-slate-950/90">
    <div class="p-3 font-semibold text-slate-200 border-b border-slate-800">
      Leads
    </div>

    <% if (leads && leads.length) { %>
      <ul class="divide-y divide-slate-800">
        <% leads.forEach(function(lead) { %>
          <li class="px-3 py-2 hover:bg-slate-800/70 cursor-pointer">
            <a href="/inbox/<%= lead._id %>">
              <div class="font-medium text-slate-100">
                <%= lead.name || lead.phone || "Unknown lead" %>
              </div>
              <div class="text-xs text-slate-400 truncate">
                <%= lead.lastMessage || lead.message || "" %>
              </div>
            </a>
          </li>
        <% }) %>
      </ul>
    <% } else { %>
      <div class="p-3 text-xs text-slate-500">
        No leads yet for this account.
      </div>
    <% } %>
  </aside>

  <!-- Middle: messages -->
  <main class="flex-1 flex flex-col">
    <% if (!activeLead) { %>
      <div class="flex-1 flex items-center justify-center text-slate-500">
        Select a lead to start conversation ðŸ‘ˆ
      </div>
    <% } else { %>
      <div class="p-3 border-b border-slate-800 font-semibold text-slate-200">
        <%= activeLead.name || activeLead.phone %>
      </div>

      <div class="flex-1 p-3 space-y-2 overflow-y-auto">
        <% messages.forEach(function(msg) { %>
          <div class="<%= msg.from === 'lead' ? 'text-left' : 'text-right' %>">
            <span class="inline-block px-3 py-2 rounded-xl
              <%= msg.from === 'lead'
                ? 'bg-slate-700 text-slate-50'
                : 'bg-emerald-500 text-slate-900' %>">
              <%= msg.text %>
            </span>
          </div>
        <% }) %>
      </div>

      <form class="p-3 border-t border-slate-800 flex gap-2"
            method="POST"
            action="/leads/<%= activeLead._id %>/reply">
        <input
          type="text"
          name="message"
          class="flex-1 px-3 py-2 rounded-xl bg-slate-900 border border-slate-700 text-slate-100"
          placeholder="Type a reply..."
          required
        />
        <button
          class="px-4 py-2 rounded-xl bg-emerald-500 text-slate-900 font-semibold">
          Send
        </button>
      </form>
    <% } %>
  </main>

  <!-- Right: lead info -->
  <aside class="w-72 border-l border-slate-800 bg-slate-950/90 p-3 text-slate-200">
    <% if (activeLead) { %>
      <h3 class="font-semibold mb-1">Lead info</h3>
      <p class="text-sm">Name: <%= activeLead.name || '-' %></p>
      <p class="text-sm">Phone: <%= activeLead.phone || '-' %></p>
      <p class="text-sm">Email: <%= activeLead.email || '-' %></p>
      <p class="text-sm mt-2">Status: <%= activeLead.qualificationLevel || 'new' %></p>
    <% } else { %>
      <p class="text-sm text-slate-500">
        Select a lead to view details.
      </p>
    <% } %>
  </aside>
</div>
